#!/bin/sh
# WRAPPER: IMPORTANT DON'T CHANGE ANYTHING HERE
[ -z "$BASH_VERSION" ] && exec bash "$0" "$@"
unset HISTSIZE

__BASE_REPO__="nene"
__DIR__="${HOME}/.basher/cellar/packages/luisadha/${__BASE_REPO__}"

args=""

# Tangani opsi lokal
while getopts ":ho:" opt; do
  case "$opt" in
    h)
      echo "Penggunaan: $0 [-h] [-o FILE]"
      echo "  -h        Tampilkan bantuan"
      echo "  -o FILE   Online mode"
      exit 0
      ;;
    o)
      online=true
      ;;
    \?)
      echo "Opsi tidak dikenal: -$OPTARG" >&2
      exit 1
      ;;
  esac
done

shift $((OPTIND - 1))

if [ "$online" = true ]; then
  read -r nene_web <<EOF
$(curl -s https://not-echo-not-true.carrd.co |
  html2text |
  grep -oP '(?<=\])\(\K[^)]+' |
  grep '^https\?://' |
  grep -E 'github\.com|github\.io|luisadha\.my\.id' |
  sort -ur |
  awk '{print $0 "\t" gensub(".*/", "", "g", $0)}' |
  fzf --with-nth=2 --prompt="Choose (script): " --delimiter='\t')
EOF
  [ -z "$nene_web" ] && echo -e "\nCaught ^C" || . <(curl -sL "$nene_web")
  exit
fi

# Jalankan Python tanpa tambahan argumen user mentah
exec python3 "${__DIR__}/not-echo-not-true.py"
